<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Lambda360 Widget Test</title>
  <style>
    body { padding: 20px; font-family: sans-serif; }
    #custom-box { width: 1000px; height: 600px; border: 1px solid #ccc; }
  </style>
</head>
<body>
  <h1>Lambda360 Widget Test (UMD/IIFE)</h1>
  
  <div id="custom-box"></div>

  <!-- Load the built widget.js -->
  <script src="./out/out/widget.js"></script>
  <script type="text/javascript">
    const { initLambda360 } = window.Lambda360;

    // 1. Schema
    const paramSchema = {
      width:  { type: "number", label: "幅",    unit: "mm", default: 300, constraint: { min: 200, max: 600, step: 10 } },
      depth:  { type: "number", label: "奥行き", unit: "mm", default: 400, constraint: { min: 200, max: 800, step: 10 } },
      height: { type: "number", label: "高さ",   unit: "mm", default: 150, constraint: { enum: [100, 150, 200] } },
      color:  { type: "color",  label: "色",     default: "#cccccc", constraint: { enum: ["#cccccc", "#336699", "#993333"] } }
    };

    // 2. Shape Generator
    const generateShape = (params) => {
      return {
        shape: {
          op: "subtract",
          a: {
             op: "stretch",
             shape: { op: "step", path: "box-base.step" },
             cut: [100, 100, 75],
             delta: [params.width - 200, params.depth - 200, params.height - 150]
          },
          b: {
            op: "translate",
            shape: { op: "step", path: "mounting-hole.step" },
            xyz: [params.width * 0.5, params.depth - 20, 0]
          }
        },
        color: params.color,
        price: 5000 + (params.width * 10)
      };
    };

    // 3. Mount
    initLambda360('#custom-box', {
      params: paramSchema,
      lambda: generateShape
    });
  </script>
</body>
</html>
